#include <iostream>
#include <string>
using namespace std;

class node{
  int data;
  node *next;
  node *prev;
  public:
  node(int data,node *next=NULL,node *prev=NULL){
    this->data=data;
    this->next=next;
    this->prev=prev;
  }
  void setdata(int x){
    data=x;
  }
  void setnext(node *n){
    next=n;
  }
  void setprev(node *p){
    prev=p;
  }
  int getdata(){
    return data;
  }
  node * getnext(){
    return next;
  }
  node * getprev(){
    return prev;
  }
};

class dll{
  node *tail;
  node *head;
  int no_of_items;
  public:
  dll(node *head=NULL,node *tail=NULL){
    this->head=head;
    this->tail=tail;
    no_of_items=0;
  }
  bool isempty(){
    return no_of_items==0;
  }
  int size(){
    return no_of_items;
  }
  void insert_head(int x){
    node *n=new node(x,head,NULL);
    if(head!=NULL){
      head->setprev(n);
    }
    head=n;
    if(tail==NULL){
      tail=n;
    }
    no_of_items++;
  }

  void insert_tail(int x){
    if(isempty()){
      insert_head(x);
      return;
    }
    node *n=new node(x);
    node *temp=tail;
    temp->setnext(n);
    tail=n;
    tail->setprev(temp);
    no_of_items++;
  }
  void insert_at(int x,int pos){
    if(pos<0||pos>=no_of_items){
      cout<<"Invalid position!!\n";
      return;
    }
    if(pos==0){
      insert_head(x);
      return;
    }
    if(pos==no_of_items-1){
      insert_tail(x);
      return;
    }
    int a=pos-2;
    node *temp=head;
    while(a>0){
      temp=temp->getnext();
      a--;
    }
    node *n=new node(x);
    node *nextnode=temp->getnext();
    temp->setnext(n);
    n->setprev(temp);
    n->setnext(nextnode);
    nextnode->setprev(n);
    no_of_items++;
  }
  
  void remove_head(){
    if(isempty()){
      return;
    }
    if(head==tail){
      delete head;
      head=tail=NULL;
      no_of_items=0;
      return;
    }
    node *temp=head;
    head=head->getnext();
    delete temp;
    head->setprev(NULL);
    no_of_items-=1;
  }
  
  void remove_tail(){
    if(isempty()){
      return;
    }
    if(head==tail){
      delete tail;
      tail=head=NULL;
      no_of_items=0;
      return;
    }
    node *temp=tail->getprev();
    delete tail;
    tail=temp;
    tail->setnext(NULL);
    no_of_items--;
  }
  
  void remove_at(int pos){
    if(isempty()){
      return;
    }
    if(pos<0||pos>=no_of_items){
      return;
    }
    if(pos==0){
      remove_head();
      return;
    }
    if(pos==no_of_items-1){
      remove_tail();
      return;
    }
    int num=pos;
    node *temp=head;
    while(num!=0){
      temp=temp->getnext();
      num--;
    }
    node *p=temp->getprev();
    p->setnext(temp->getnext());
    temp->getnext()->setprev(p);
    delete temp;
    no_of_items--;
  }
  
  void remove_all_occurance(int x){
    if(isempty()){
      return;
    }
    node *curr=head;
    while(curr!=NULL){
      node *next=curr->getnext(); 
      if(curr->getdata()==x){
        if(curr==head){
          head=curr->getnext();
          if(head!=NULL)
            head->setprev(NULL);
          else
            tail=NULL;
        }
        else if(curr==tail){
          tail=curr->getprev();
          tail->setnext(NULL);
        }
        else{
          node *p=curr->getprev();
          node *n=curr->getnext();
          p->setnext(n);
          n->setprev(p);
        }
        delete curr;
        no_of_items--;
      }
  
      curr = next;
    }
  }

  void display(){
    node *temp=head;
    while(temp!=NULL){
      cout<<temp->getdata()<<" ";
      temp=temp->getnext();
    }
    cout<<endl;
  }
};

int main() 
{
  dll obj,obj1;
  obj.insert_head(23);
  obj.insert_head(73);
  obj.insert_head(9);
  obj.insert_tail(4);
  obj.insert_tail(4);
  obj.insert_head(92);
  obj.insert_head(4);
  obj.insert_head(4);
  obj.insert_head(38);
  obj.insert_head(4);
  obj.insert_head(4);
  cout<<"Original linked list:\n";
  obj.display();
  cout<<"After removing all occurrence of 4:\n";
  obj.remove_all_occurance(4);
  obj.display();
  return 0;
}
